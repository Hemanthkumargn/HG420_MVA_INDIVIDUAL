---
title: "Lung cancer Cluster analysis"
author: "hg420@scarletmail.rutgers.edu"
date: "2024-03-08"
output: html_document
---

# Cluster Analysis
```{r}


library(cluster)
library(readr)
library(factoextra)
library(magrittr)
library(NbClust)

lung <- read.csv("C:/Users/user/Desktop/Spring2024/MVA/Project/Hemanth/LUNGCANCER3.csv")
lung
matstd.lung <- scale(lung)
lung_scaled <- scale(lung)
attach(lung)
dim(lung)
str(lung)
lung$LUNG_CANCER <- as.factor(lung$LUNG_CANCER)
str(lung)

# Lets see what the optimal numbers of clusers are
# Compute
res.nbclust <- lung_scaled %>% scale() %>% NbClust(distance = "euclidean", min.nc = 2, max.nc = 10, method = "complete", index ="all") 

# Perform k-means clustering with 3 clusters (Non - hierarchical)
set.seed(123)
k3 <- kmeans(lung_scaled, centers = 3, nstart = 25)

# Visualize the clustering results with a scatter plot
fviz_cluster(k3, data = lung_scaled)

# Determine the optimal number of clusters 
fviz_nbclust(lung_scaled, kmeans, method = "wss")
# Assign cluster labels to the original dataset
lung$cluster <- as.factor(k3$cluster)
lung$cluster

# Hierarchial Clusiering
res.hc <- lung_scaled %>% scale() %>% dist(method = "euclidean") %>%
  hclust(method = "ward.D2")

fviz_dend(res.hc, k = 3, # Cut in three groups
          cex = 0.5, # label size
          k_colors = c("#2E9FDF", "#E7B800", "#FC4E07"),
          color_labels_by_k = TRUE, # color labels by groups
          rect = TRUE # Add rectangle around groups
          )

```